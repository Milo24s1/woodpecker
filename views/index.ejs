<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Prospectgenai</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">


    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Bootstrap core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.9/css/mdb.min.css" rel="stylesheet">


</head>
<body>
<nav class="navbar navbar-dark primary-color">
    <a class="navbar-brand" href="#">
        <!--<img src="https://mdbootstrap.com/img/logo/mdb-transparent.png" height="30" class="d-inline-block align-top" alt="">-->
        <img src="/img/ProspectGen_AI01_white.png" height="30" class="d-inline-block align-top" alt="">
    </a>
    <a href="add"><button type="button" class="btn purple btn-lg">Add Token</button></a>
</nav>
<div style="height: 10vh">
</div>
<div id="tableDiv" class="row">
    <div class="col-2"></div>
    <div class="col-8">
        <table class="table">
            <thead class="orange white-text">
            <tr>
                <th scope="col">Company</th>
                <th scope="col">Campaign</th>
                <th scope="col">Prospects</th>
                <th scope="col">Email Delivered</th>
                <th scope="col">Opened</th>
                <th scope="col">Responses</th>
            </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
    <div class="col-2"></div>
</div>
<div class="flex-center flex-column">
    <div id="loader" class="loader invisible center-block"></div>
</div>

<div style="height: 10vh">
</div>

<!-- Footer -->
<footer class="page-footer font-small teal">

    <!-- Copyright -->
    <div class="footer-copyright text-center py-3">Â© 2018 Copyright:
        <a href="https:// prospectgenai.com/">  prospectgenai.com</a>
    </div>
    <!-- Copyright -->

</footer>
<!-- Footer -->

<!-- JQuery -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.13.0/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.5.9/js/mdb.min.js"></script>



<script>
    $(document).ready(function () {


        lazyLoad();
        function lazyLoad(next) {
            $("#loader").removeClass('invisible');
            $.ajax({
                url : '/search',
                data: {
                    next : next
                },
                method: 'post',
                datatype: 'json',
                success: function (data) {
                    let tableDom = '';
                    console.log(data.rowData.length > 0);
                    if(true){
                        for(i=0;i<data.rowData.length;i++){
                            tableDom += `<tr>
                                        <th scope="row">${data.rowData[i].company}</th>
                                        <td>${data.rowData[i].campaign}</td>
                                        <td>${data.rowData[i].prospects}</td>
                                        <td>${data.rowData[i].delivered} (${data.rowData[i].deliveredPrecentage}%)</td>
                                        <td>${data.rowData[i].opened} (${data.rowData[i].openedPrecentage}%)</td>
                                        <td>${data.rowData[i].responses} (${data.rowData[i].responsesPrecentage}%)</td>
                                        </tr>`
                        }
                        $("table").append(tableDom)
                    }
                    $("#loader").addClass('invisible');
                    if(data.next != undefined){
                        lazyLoad(data.next);
                    }


                },
                error : function (xhr, ajaxOptions, thrownError) {

                    if(xhr.status!=200) {
                        $("#loader").addClass('invisible');
                    }
                }
            });
        }
    });


</script>
<style>
    .loader {
        border: 16px solid #f3f3f3; /* Light grey */
        border-top: 16px solid #3498db; /* Blue */
        border-radius: 50%;
        width: 120px;
        height: 120px;
        animation: spin 2s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
</style>
</body>
</html>